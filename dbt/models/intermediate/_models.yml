
version: 2

models:
  - name: int_order_items_enriched
    description: Order informations on the item level enriched with order context, customer, product price and business metrics
    columns:
      - name: order_item_id
        description: "{{ doc('order_items__item_id') }}"
        data_tests:
          - unique
          - not_null
      - name: order_id
        description: "{{ doc('order_items__order_id') }}"
        data_tests:
          - not_null
          - relationships:
              arguments:
                to: ref('stg_orders')
                field: order_id
      - name: customer_id
        description: "{{ doc('orders__customer_id') }}"
        data_tests:
          - not_null
      - name: product_id
        description: "{{ doc('order_items__product_id') }}"
        data_tests:
          - not_null
          - relationships:
              arguments:
                to: ref('stg_products')
                field: product_id
      - name: order_date
        description: "{{ doc('orders__order_date') }}"
        data_tests:
          - not_null
      - name: order_status
        description: "{{ doc('orders__status') }}"
      - name: quantity
        description: "{{ doc('order_items__quantity') }}"
      - name: unit_price
        description: "{{ doc('products__price') }}"
      - name: gross_amount
        description: Gross amount for the item
  - name: int_orders_aggregated
    description: Order items aggregated to the order level
    columns:
      - name: order_item_id
        description: "{{ doc('orders__order_id') }}"
        data_tests:
          - unique
          - not_null
      - name: customer_id
        description: "{{ doc('orders__customer_id') }}"
        data_tests:
          - not_null
      - name: order_date
        description: "{{ doc('orders__order_date') }}"
        data_tests:
          - not_null
      - name: order_status
        description: "{{ doc('orders__status') }}"
      - name: total_line_items
        description: Total number of item lines in the order
      - name: total_quantity
        description: Total quantity of items in the order
      - name: order_total_amount
        description: Total amount of the order